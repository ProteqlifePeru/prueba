<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìû Dashboard Llamadas 107 - ESSALUD</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/a2d04b6a6a.js" crossorigin="anonymous"></script>
<style>
:root {
  --primary: #0066cc;
  --secondary: #00a859;
  --accent: #e7f1ff;
  --bg: linear-gradient(135deg,#d0e7ff,#f0f9ff);
  --text: #222;
  --card-bg: #fff;
  --radius: 16px;
  --shadow: 0 12px 40px rgba(0,0,0,0.15);
}
* {box-sizing:border-box;}
body {
  font-family:'Poppins',sans-serif;
  margin:0; padding:0;
  background: var(--bg);
  display:flex; justify-content:center; min-height:100vh;
}
.container {
  width: 80%;
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
}
h1 {
  text-align:center;
  color: var(--primary);
  font-size:28px;
  font-weight:700;
  margin-bottom:30px;
  text-shadow:1px 1px 2px rgba(0,0,0,0.1);
}
.card {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:20px 25px;
  margin-bottom:25px;
  transition: transform 0.3s, box-shadow 0.3s;
}
.card:hover {transform: translateY(-5px); box-shadow:0 20px 50px rgba(0,0,0,0.25);}
.section-title {
  margin-top:20px;
  margin-bottom:10px;
  font-size:20px;
  font-weight:600;
  color: var(--primary);
  border-left:5px solid var(--primary);
  padding-left:10px;
  display:flex; align-items:center; gap:8px;
}
label {display:block; margin-top:12px; font-weight:500; font-size:14px;}
input, select {
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:14px;
  transition:0.3s;
}
input:focus, select:focus {
  outline:none; border-color: var(--primary);
  box-shadow:0 0 8px rgba(0,102,204,0.3);
  background: var(--accent);
}
input[readonly], select[readonly] {background:#f0f0f0;}
#nombreCompleto {
  font-size:20px;
  font-weight:700;
  color:#000;
  text-align:center;
  border:2px solid #ccc;
  border-radius:14px;
  padding:10px;
  transition:0.3s;
}
.flex {display:flex; gap:15px; flex-wrap:wrap;}
.flex-2 > div, .flex-3 > div {flex:1;}
.flex-3 > div {min-width:150px;}
button {
  padding:12px;
  background: var(--secondary);
  color:white;
  border:none;
  border-radius:14px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  transition:0.3s;
}
button:hover {
  transform: translateY(-2px);
  box-shadow:0 5px 20px rgba(0,0,0,0.2);
}
#btnLimpiar, #btnCerrarSesion {background:#cc0000;}
#btnLimpiar:hover, #btnCerrarSesion:hover {background:#990000;}
#mensajeDNI {
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  background: #d0e7ff;
  color: #0066cc;
  padding: 8px 12px;
  border-radius: 12px;
  font-size: 14px;
  margin-top: 5px;
  display: none;
  text-align: center;
  border: 1px solid #b0dbff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  z-index: 10;
}
#mensajeDNI.error {
  background: #f8d7da;
  color: #721c24;
  border-color: #f5c6cb;
}
#mensajeDNI.success {
  background: #d0f2e0;
  color: #155724;
  border-color: #c3e6cb;
}
#motivoOtro {
  width:100%; padding:10px 12px; border-radius:12px;
  margin-top:8px; font-size:14px;
  display:none;
  border:1px solid #ff9800; background:#fff8e1; color:#e65100;
  box-shadow:0 0 6px rgba(255,152,0,0.2);
}
</style>
</head>
<body>
<div class="container">
  <button id="btnCerrarSesion" style="margin-bottom:15px; display:none;">
    <i class="fas fa-sign-out-alt"></i> Cerrar sesi√≥n
  </button>

  <h1><i class="fas fa-phone-volume"></i> Dashboard Llamadas 107 - ESSALUD</h1>
  <div class="card">
    <div id="contadorDuracion"></div>

    <div class="section-title"><i class="fas fa-clock"></i> Fecha y hora de inicio</div>
    <input type="text" id="fechaInicio" readonly style="
      width:100%; padding:10px 12px; border-radius:12px;
      background:#f0f0f0; color:#333; font-weight:500;
      text-align:center; letter-spacing:0.5px;
    ">

    <div class="section-title"><i class="fas fa-user-md"></i> Datos del Profesional</div>
    <div class="flex flex-2">
      <div>
        <label>Profesi√≥n</label>
        <input type="text" id="profesion" readonly style="background:#f0f0f0; color:#333; font-weight:500;">
      </div>
      <div>
        <label>Personal</label>
        <select id="personal">
          <option value="">Seleccione...</option>
        </select>
      </div>
    </div>

    <div class="section-title"><i class="fas fa-phone"></i> Datos de la Llamada</div>
    <label>Opciones de llamada üìû</label>
    <select id="opcionLlamada">
      <option value="">Seleccione...</option>
      <option>Opci√≥n 0 - Informaci√≥n sobre vacunaci√≥n</option>
      <option>Opci√≥n 1 - Informaci√≥n medicina general</option>
      <option>Opci√≥n 2 - L√≠nea del paciente cr√≥nico</option>
      <option>Opci√≥n 3 - Informaci√≥n en psicolog√≠a</option>
      <option>Opci√≥n 4 - Asesor√≠a en nutrici√≥n</option>
      <option>Opci√≥n 5 - Enfermedades varias</option>
      <option>Opci√≥n 6 - Casos de violencia contra la mujer</option>
      <option>Opci√≥n 7 - Atenci√≥n a personas vulnerables</option>
      <option>Opci√≥n 8 - L√≠nea del donante</option>
      <option>Opci√≥n 9 - Oncol√≠nea ESSALUD</option>
      <option>LLAMADAS MAL INTENCIONADAS</option>
    </select>
    <label>N√∫mero de tel√©fono üì±</label>
    <input type="tel" id="telefono" placeholder="Ej. 987654321">

    <div class="section-title"><i class="fas fa-user"></i> Datos del Paciente</div>
    <div class="flex flex-2">
      <div>
        <label>Tipo de documento üÜî</label>
        <select id="tipoDoc">
          <option value="DNI" selected>DNI</option>
          <option>CE</option>
          <option>PASS</option>
          <option>C√âDULA</option>
          <option>AN√ìNIMO</option>
        </select>
      </div>
      <div style="position:relative; width:100%;">
        <label>N¬∞ Documento</label>
        <input type="text" id="dni" maxlength="12" placeholder="Ingrese el n√∫mero">
        <div id="mensajeDNI">
          <i class="fas fa-info-circle" style="margin-right:5px;"></i>
          <span id="mensajeDNITexto"></span>
        </div>
      </div>
    </div>
    <label>Nombre completo üë§</label>
    <input type="text" id="nombreCompleto" readonly>
    <div class="flex flex-2">
      <div>
        <label>Sexo</label>
        <select id="sexo" readonly>
          <option value="">Seleccione...</option>
          <option>M</option>
          <option>F</option>
        </select>
      </div>
      <div>
        <label>Fecha de nacimiento üìÖ</label>
        <input type="date" id="fechaNac" readonly>
      </div>
    </div>
    <label>Edad actual üßÆ</label>
    <input type="text" id="edad" readonly>

    <div class="section-title"><i class="fas fa-map-marker-alt"></i> Ubicaci√≥n üó∫Ô∏è</div>
    <div class="flex flex-3">
      <div>
        <label>Departamento</label>
        <select id="departamento">
          <option value="">Seleccione...</option>
        </select>
      </div>
      <div>
        <label>Provincia</label>
        <select id="provincia">
          <option value="">Seleccione...</option>
        </select>
      </div>
      <div>
        <label>Distrito</label>
        <select id="distrito">
          <option value="">Seleccione...</option>
        </select>
      </div>
    </div>

    <!-- ========== MOTIVO DE LA LLAMADA ========== -->
    <div class="section-title"><i class="fas fa-sticky-note"></i> Motivo de la llamada</div>
    <select id="motivoLlamada" style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid #ccc; font-size:14px;">
      <option value="">Seleccione el motivo...</option>
      <option>ALTERACION DE LA COMPOSICION MASA CORPORAL</option>
      <option>ALTERACIONES DE LA GLUCOSA</option>
      <option>ALTERACIONES DE LA PIEL Y FANERAS</option>
      <option>ALTERACIONES DE LA TIROIDES</option>
      <option>ALTERACIONES DE LA VISI√ìN</option>
      <option>ALTERACIONES EN EL O√çDO</option>
      <option>ALTERACIONES EN LA PIEL</option>
      <option>MOLESTIAS URINARIAS</option>
      <option>ANEMIA</option>
      <option>AYUDA AL DIAGNOSTICO</option>
      <option>CONSULTAS RELACIONADOS AL EMBARAZO</option>
      <option>CRECIMIENTO Y DESARROLLO O NI√ëO SANO</option>
      <option>DEMENCIAS</option>
      <option>DISCAPACIDAD</option>
      <option>DISMINUCI√ìN DE LA AGUDEZA VISUAL</option>
      <option>DOLOR DE CABEZA</option>
      <option>DOLOR LUMBAR</option>
      <option>FIEBRE</option>
      <option>HIPOACUSIA</option>
      <option>INFORMACI√ìN SOBRE TEMAS ADMINISTRATIVOS</option>
      <option>MORDEDURAS O PICADURAS DE ANIMALES</option>
      <option>OTROS PROBLEMAS CARDIOVASCULARES</option>
      <option>P. RELACIONADOS CON ALTERACIONES PSICOLOGICAS</option>
      <option>P. RELACIONADOS CON FACTORES PROTECTORES Y/O DE RIESGOS</option>
      <option>P. RELACIONADOS CON VIOLENCIA</option>
      <option>PATOLOGIAS MUSCULOESQUELETICAS</option>
      <option>PLANIFICACION FAMILIAR</option>
      <option>PRESENCIA DE CUERPO EXTRA√ëO</option>
      <option>PRESI√ìN ARTERIAL DISMINUIDA (HIPOTENSI√ìN)</option>
      <option>PRESION ARTERIAL ELEVADA</option>
      <option>PREVENCION Y PROMOCION EN SALUD</option>
      <option>PROBLEMAS ODONTOLOGICOS</option>
      <option>REACCIONES AL√âRGICAS LEVES</option>
      <option>SECRECION CONJUNTIVAL</option>
      <option>SINTOMAS GASTROINTESTINALES</option>
      <option>SINTOMAS RESPIRATORIOS</option>
      <option>TRASTORNOS DEL AFECTO</option>
      <option>TRAUMATISMO SIN PERDIDA DE MOVILIDAD</option>
      <option>VACUNACI√ìN</option>
      <option>VERTIGO O MAREOS SIN TRAUMA PREVIO</option>
      <option>OTROS</option>
    </select>
    <input type="text" id="motivoOtro" placeholder="Especifique el motivo..." />

    <!-- ========== AFILIACI√ìN ========== -->
    <div class="section-title"><i class="fas fa-id-badge"></i> Afiliaci√≥n</div>
    <select id="afiliacion" style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid #ccc; font-size:14px;">
      <option value="ESSALUD" selected>ESSALUD</option>
      <option value="SIS">SIS</option>
      <option value="SEGURO PARTICULAR">SEGURO PARTICULAR</option>
      <option value="NINGUNO">NINGUNO</option>
    </select>

    <!-- ========== DERIVACI√ìN INTERNA ========== -->
    <div class="section-title"><i class="fas fa-arrow-right"></i> Derivaci√≥n interna</div>
    <select id="derivacionInterna" style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid #ccc; font-size:14px;">
      <option value="">Seleccione...</option>
      <option>CENTRO ADULTO MAYOR</option>
      <option>CRUEN / URGENCIAS PADOMI 117</option>
      <option>MEDICINA CENATE</option>
      <option>NUTRICION CENATE</option>
      <option>PADOMI NI√ëOS</option>
      <option>PROGRAMA MUJER TRANSFORMADORA</option>
      <option>PROGRAMAS PARA NI√ëOS Y ADOLESCENTES</option>
      <option>PSICOLOGIA CENATE</option>
      <option>VACUNA MOVIL CEPRIT</option>
      <option>NINGUNA</option>
    </select>

    <!-- ========== DERIVACI√ìN EXTERNA ========== -->
    <div class="section-title"><i class="fas fa-phone-arrow-out"></i> Derivaci√≥n externa</div>
    <select id="derivacionExterna" style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid #ccc; font-size:14px;">
      <option value="">Seleccione...</option>
      <option>LINEA 113</option>
      <option>INFOSALUD</option>
      <option>NINGUNA</option>
    </select>

    <label>Fecha y hora de t√©rmino ‚è∞</label>
    <input type="text" id="fechaTermino" readonly>
    <div class="flex" style="gap:10px; margin-top:20px;">
      <button id="btnGuardar"><i class="fas fa-save"></i> Guardar Registro</button>
      <button id="btnLimpiar"><i class="fas fa-eraser"></i> Limpiar Todo</button>
    </div>
  </div>
</div>

<script>
// ---------- Referencias ----------
const $ = s => document.querySelector(s);
const el = {
  dni: $('#dni'),
  nombreCompleto: $('#nombreCompleto'),
  sexo: $('#sexo'),
  fechaNac: $('#fechaNac'),
  edad: $('#edad'),
  departamento: $('#departamento'),
  provincia: $('#provincia'),
  distrito: $('#distrito'),
  profesion: $('#profesion'),
  personal: $('#personal'),
  opcionLlamada: $('#opcionLlamada'),
  telefono: $('#telefono'),
  tipoDoc: $('#tipoDoc'),
  motivoLlamada: $('#motivoLlamada'),
  motivoOtro: $('#motivoOtro'),
  afiliacion: $('#afiliacion'),
  derivacionInterna: $('#derivacionInterna'),
  derivacionExterna: $('#derivacionExterna'),
  btnGuardar: $('#btnGuardar'),
  btnLimpiar: $('#btnLimpiar'),
  btnCerrarSesion: $('#btnCerrarSesion'),
  mensajeDNI: $('#mensajeDNI'),
  mensajeDNITexto: $('#mensajeDNITexto'),
  contadorDuracion: $('#contadorDuracion'),
  fechaInicio: $('#fechaInicio'),
  fechaTermino: $('#fechaTermino')
};

// ---------- Fecha de inicio ----------
function formatoFecha(f){
  const d = String(f.getDate()).padStart(2,'0');
  const m = String(f.getMonth()+1).padStart(2,'0');
  const y = f.getFullYear();
  const h = String(f.getHours()).padStart(2,'0');
  const min = String(f.getMinutes()).padStart(2,'0');
  const s = String(f.getSeconds()).padStart(2,'0');
  return `${d}_${m}_${y} ${h}:${min}:${s}`;
}
if (el.fechaInicio) el.fechaInicio.value = formatoFecha(new Date());

// ---------- Contador ----------
let inicioLlamada = new Date();
function actualizarContador(){
  const ahora = new Date();
  let diff = Math.floor((ahora - inicioLlamada) / 1000);
  const h = String(Math.floor(diff / 3600)).padStart(2,'0');
  diff %= 3600;
  const m = String(Math.floor(diff / 60)).padStart(2,'0');
  const s = String(diff % 60).padStart(2,'0');
  el.contadorDuracion.textContent = `‚è±Ô∏è Duraci√≥n de la llamada: ${h}:${m}:${s}`;
}
setInterval(actualizarContador, 1000);

// ---------- Personal ‚Üí Profesi√≥n ----------
const personalLista = {
  "ALBITRES VIDAL RODRIGO": "PSICOLOG√çA",
  "ALMONACIN MALLQUI JASMIN": "PSICOLOG√çA",
  "ALVARON PEREZ GREETEL VANESSA": "ENFERMER√çA",
  "ANCO SOLORZANO CINDY": "ENFERMER√çA",
  "ARANDA MARENGO MAR√çA ISABEL": "ENFERMER√çA",
  "ARROYO JARA ALESSANDRA": "NUTRICIONISTA",
  "AYALA HUA√ëA EDITH": "OBSTETRICIA",
  "BENITES MORENO HENRY": "NUTRICIONISTA",
  "BERNABE ORELLANO PAULA MAR√çA": "ENFERMER√çA",
  "CALDERON CAHUANTICO LUCY MELISA": "NUTRICIONISTA",
  "CARDENAS KRAPP ZARELA LUCIEN": "MEDICINA",
  "CASTILLO ROMERO CARLA": "PSICOLOG√çA",
  "CAYLLAHUA QUISPE YAKELIN": "PSICOLOG√çA",
  "CUBAS JARA MILAGROS MALLENA": "MEDICINA",
  "CUSTODIO SALAZAR LENIN RUBEN": "ENFERMER√çA",
  "DEL CASTILLO BARRIENTOS MILAGROS DEL ROCIO": "PSICOLOG√çA",
  "ECOS RAMOS FANNY LOURDES": "ENFERMER√çA",
  "ESPINOZA SALCEDO NANCY": "OBSTETRICIA",
  "FERNANDEZ HUARHUACHI YURINA": "MEDICINA",
  "GALVEZ CALVO ALESSANDRA ISABEL INES": "OBSTETRICIA",
  "GOMEZ MARIN ALICIA PATRICIA": "OBSTETRICIA",
  "GUARDAMINO GUILLEN MARIELA DEYSI": "ENFERMER√çA",
  "GUTARRA MENDEZ ARTURO ENRIQUE": "PSICOLOG√çA",
  "HERQUINIO VEGA CARMEN ROCIO": "ENFERMER√çA",
  "HINOSTROZA YARASCA EDER": "ENFERMER√çA",
  "HORNA QUEVEDO GUILIANA": "PSICOLOG√çA",
  "IGNACIO ESPINOZA KATHERINE": "OBSTETRICIA",
  "LAPA PEREZ NURIA GENOVEVA": "ASISTENTE SOCIAL",
  "LAVALLE LESCANO ELIANA": "OBSTETRICIA",
  "LAZO MONTOYA YESSENIA": "NUTRICIONISTA",
  "MENDOZA GIRALDO JESARELA JEZIEL": "OBSTETRICIA",
  "MU√ëOZ BARRIOS ANNGIE DEL ROSARIO": "ENFERMER√çA",
  "OLIVARES MENDOZA ROSA INES": "MEDICINA",
  "PAREDES CASTILLO LUBY EDITA": "OBSTETRICIA",
  "RIVERA CORDOVA XIMENA CLAUDIA": "PSICOLOG√çA",
  "ROBLES ALFARO RICARDO ALESSANDRO": "MEDICINA",
  "SALAZAR CUEVA EVELYN": "NUTRICIONISTA",
  "SALINAS BOGGIO RAM": "MEDICINA",
  "SALVADOR CALZADA JESSICA": "ENFERMER√çA",
  "VITE CELEDONIO MARIA": "ENFERMER√çA",
  "YPANAQU√â CELIS, CINTHYA LAURA": "OBSTETRICIA",
  "ZEGARRA DE LAMA MAGALY REINELIA": "PSICOLOG√çA",
  "ZU√ëIGA SANCHEZ SANDRA": "PSICOLOG√çA"
};

Object.keys(personalLista).forEach(nombre => {
  const opt = document.createElement('option');
  opt.value = nombre;
  opt.textContent = nombre;
  el.personal.appendChild(opt);
});

el.personal.addEventListener('change', () => {
  const nombre = el.personal.value;
  el.profesion.value = personalLista[nombre] || '';
  if (nombre && personalLista[nombre]) {
    localStorage.setItem('usuarioActivo', nombre);
    el.personal.disabled = true;
    el.profesion.style.background = '#e7f1ff';
    el.btnCerrarSesion.style.display = 'inline-block';
  } else {
    localStorage.removeItem('usuarioActivo');
    el.profesion.value = '';
    el.personal.disabled = false;
    el.profesion.style.background = '#f0f0f0';
    el.btnCerrarSesion.style.display = 'none';
  }
});

window.addEventListener('load', () => {
  const nombre = localStorage.getItem('usuarioActivo');
  if (nombre && personalLista[nombre]) {
    el.personal.value = nombre;
    el.profesion.value = personalLista[nombre];
    el.personal.disabled = true;
    el.profesion.style.background = '#e7f1ff';
    el.btnCerrarSesion.style.display = 'inline-block';
  }
});

el.btnCerrarSesion.addEventListener('click', () => {
  localStorage.removeItem('usuarioActivo');
  el.personal.value = '';
  el.profesion.value = '';
  el.personal.disabled = false;
  el.profesion.style.background = '#f0f0f0';
  el.btnCerrarSesion.style.display = 'none';
  inicioLlamada = new Date();
});

// ---------- Motivo de llamada condicional ----------
el.motivoLlamada.addEventListener('change', () => {
  if (el.motivoLlamada.value === 'OTROS') {
    el.motivoOtro.style.display = 'block';
    el.motivoOtro.focus();
  } else {
    el.motivoOtro.style.display = 'none';
    el.motivoOtro.value = '';
  }
});

// ---------- DNI con mensaje localizado ----------
let debounceTimer;
el.dni.addEventListener('input', e => {
  const dni = e.target.value.trim();
  clearTimeout(debounceTimer);
  if (dni.length >= 8) {
    debounceTimer = setTimeout(() => buscarDNI(dni), 500);
  }
});

function mostrarMensajeDNI(texto, tipo = 'info') {
  el.mensajeDNITexto.textContent = texto;
  el.mensajeDNI.className = '';
  el.mensajeDNI.classList.add(tipo);
  el.mensajeDNI.style.display = 'block';
  setTimeout(() => {
    el.mensajeDNI.style.display = 'none';
  }, 5000);
}

// ---------- API (SIN CAMBIOS) ----------
async function buscarDNI(dni){
  const urls = [`http://172.20.60.152:8000/buscar/${dni}`];
  let data = null;
  for(const url of urls){
    try{
      const res = await fetch(url);
      if(res.ok){
        data = await res.json();
        mostrarMensajeDNI(`‚úÖ Conectado: ${url}`, 'success');
        break;
      }
    }catch(e){}
  }
  if(data && (data.DNI || data.dni)){
    el.nombreCompleto.value = data.NOMBRE_COMPLETO || data.nombre_completo || '';
    el.nombreCompleto.style.background = '#d0f2e0';
    el.sexo.value = data.SEXO || data.sexo || '';
    let fechaServer = data.FECHA_NAC || data.fecha_nacimiento || '';
    if(fechaServer){
      let parts = fechaServer.split(/[-/_]/);
      if(parts.length===3){
        let day = parts[0].padStart(2,'0');
        let month = parts[1].padStart(2,'0');
        let year = parts[2];
        el.fechaNac.value = `${year}-${month}-${day}`;
      }
    }
    calcularEdad();
  } else {
    mostrarMensajeDNI('‚ö†Ô∏è No se encontr√≥ el DNI. Complete los datos manualmente.', 'error');
    el.nombreCompleto.value = '';
    el.nombreCompleto.style.background = '#f8d7da';
    el.nombreCompleto.removeAttribute('readonly');
    el.fechaNac.removeAttribute('readonly');
    el.sexo.removeAttribute('readonly');
  }
}

// ---------- Edad ----------
el.fechaNac.addEventListener('change', calcularEdad);
function calcularEdad(){
  const fechaNac = new Date(el.fechaNac.value);
  if(isNaN(fechaNac)) return;
  const hoy = new Date();
  let a√±os = hoy.getFullYear() - fechaNac.getFullYear();
  let meses = hoy.getMonth() - fechaNac.getMonth();
  let dias = hoy.getDate() - fechaNac.getDate();
  if(dias<0){ meses--; const mesAnt = new Date(hoy.getFullYear(), hoy.getMonth(),0); dias+=mesAnt.getDate();}
  if(meses<0){a√±os--;meses+=12;}
  el.edad.value = `${a√±os} a√±os, ${meses} meses, ${dias} d√≠as`;
}

// ---------- Guardar ----------
el.btnGuardar.addEventListener('click', () => {
  const campos = [
    {id:'profesion', nombre:'Profesi√≥n'},
    {id:'personal', nombre:'Personal'},
    {id:'opcionLlamada', nombre:'Opci√≥n de llamada'},
    {id:'telefono', nombre:'Tel√©fono'},
    {id:'tipoDoc', nombre:'Tipo de documento'},
    {id:'dni', nombre:'N√∫mero de documento'},
    {id:'nombreCompleto', nombre:'Nombre completo'},
    {id:'sexo', nombre:'Sexo'},
    {id:'fechaNac', nombre:'Fecha de nacimiento'},
    {id:'departamento', nombre:'Departamento'},
    {id:'provincia', nombre:'Provincia'},
    {id:'distrito', nombre:'Distrito'},
    {id:'motivoLlamada', nombre:'Motivo de la llamada'},
    {id:'afiliacion', nombre:'Afiliaci√≥n'},
    {id:'derivacionInterna', nombre:'Derivaci√≥n interna'},
    {id:'derivacionExterna', nombre:'Derivaci√≥n externa'}
  ];

  for (const c of campos) {
    if (!document.getElementById(c.id).value.trim()) {
      alert(`‚ùå Complete: ${c.nombre}`);
      return;
    }
  }

  if (el.motivoLlamada.value === 'OTROS') {
    const otro = el.motivoOtro.value.trim();
    if (!otro) {
      alert('‚ùå Especifique el motivo en "OTROS"');
      el.motivoOtro.focus();
      return;
    }
  }

  el.fechaTermino.value = formatoFecha(new Date());
  alert('‚úÖ Registro guardado correctamente.');
});

// ---------- Limpiar ----------
el.btnLimpiar.addEventListener('click',()=>{
  document.querySelectorAll('input').forEach(i=>i.value='');
  document.querySelectorAll('select').forEach(s=>s.selectedIndex = 0);
  el.nombreCompleto.style.background='#fff';
  el.mensajeDNI.style.display = 'none';
  el.motivoOtro.style.display = 'none';
  inicioLlamada = new Date();
});

// ---------- Ubigeos completos ----------
const ubigeos = {
  "AMAZONAS": {"provincias":["Bagua","Bongar√°","Condorcanqui","Chachapoyas","Luya","Rodr√≠guez de Mendoza","Utcubamba"],"distritos":{"Bagua":["Aramango","Copall√≠n","El Parco","La Peca","Bagua","Imaza"],"Bongar√°":["Jumbilla","Chisquilla","Churuja","Corosha","Cuispes","Florida","Jazan","Recta","San Carlos","Shipasbamba","Valera","Yambrasbamba"],"Condorcanqui":["Nieva","El Cenepa","R√≠o Santiago"],"Chachapoyas":["Chachapoyas","Asunci√≥n","Balsas","Cheto","Chiliqu√≠n","Chuquibamba","Granada","Huancas","La Jalca","Leimebamba","Levanto","Magdalena","Mariscal Castilla","Molinopampa","Montevideo","Olleros","Quinjalca","San Francisco de Daguas","San Isidro de Maino","Soloco","Sonche"],"Luya":["L√°mud","Camporredondo","Cocabamba","Colcamar","Conila","Inguilpata","Longuita","Lonya Chico","Luya","Luya Viejo","Mar√≠a","Ocalli","Ocumal","Pisuqu√≠a","Providencia","San Crist√≥bal","San Francisco del Yeso","San Jer√≥nimo","San Juan de Lopecancha","Tingo","Trita"],"Rodr√≠guez de Mendoza":["San Nicol√°s","Chirimoto","Cochamal","Huambo","Limabamba","Longar","Mariscal Benavides","Milpuc","Omia","Santa Rosa","Totora","Vista Alegre"],"Utcubamba":["Bagua Grande","Cajaruro","Cumba","El Milagro","Jamalca","Lonya Grande","Yam√≥n"]}},
  "ANCASH": {"provincias":["Aija","Antonio Raymondi","Asunci√≥n","Bolognesi","Carhuaz","Carlos Ferm√≠n Fitzcarrald","Casma","Corongo","Huari","Huarmey","Huaylas","Mariscal Luzuriaga","Ocros","Pallasca","Pomabamba","Recuay","Santa","Sihuas","Yungay"],"distritos":{"Aija":["Aija","Coris","Huacll√°n","La Merced","Succha"],"Antonio Raymondi":["Llamell√≠n","Aczo","Chaccho","Chingas","Mirgas","San Juan de Rontoy"],"Asunci√≥n":["Chacas","Acochaca"],"Bolognesi":["Chiqui√°n","Abelardo Pardo Lezameta","Antonio Raymondi","Aquia","Cajacay","Canis","Colquioc","Huallanca","Huasta","Huayllacay√°n","La Primavera","Mangas","Pacll√≥n","San Miguel de Corpanqui","Ticllos"],"Carhuaz":["Carhuaz","Acopampa","Amashca","Anta","Ataquero","Marcara","Pariahuanca","San Miguel de Aco","Shilla","Tinco","Yacu"],"Carlos Ferm√≠n Fitzcarrald":["San Luis","San Nicol√°s","Yauya"],"Casma":["Casma","Buena Vista Alta","Comandante Noel","Yautan"],"Corongo":["Corongo","Aco","Bambas","Cusca","La Pampa","Y√°nac","Yauya"],"Huari":["Huari","Anra","Cajay","Chav√≠n de Hu√°ntar","Huacachi","Huacchis","Huachis","Huantar","Masin","Paucas","Ponto","Rahuapampa","Rapay√°n","San Marcos","San Pedro de Chana","Uco"],"Huarmey":["Huarmey","Cochapeti","Culebras","Huay√°n","Malvas"],"Huaylas":["Caraz","Huallanca","Huata","Huaylas","Mato","Pamparomas","Pueblo Libre","Santa Cruz","Santo Toribio","Yuracmarca"],"Mariscal Luzuriaga":["Piscobamba","Casca","Eleazar Guzm√°n Barr√≥n","Fidel Olivas Escudero","Llama","Llumpa","Lucma","Musga"],"Ocros":["Ocros","Acas","Cajamarquilla","Carhuapampa","Cochas","Congas","Llipa","San Crist√≥bal de Raj√°n","San Pedro"],"Pallasca":["Cabana","Bolognesi","Conchucos","Huacaschuque","Huandoval","Lacabamba","Llapo","Pallasca","Pampas","Santa Rosa","Tauca"],"Pomabamba":["Pomabamba","Huayll√°n","Parobamba","Quinuabamba"],"Recuay":["Recuay","Catac","Cotaparaco","Huayllapampa","Llacll√≠n","Marca","Pampas Chico","Parar√≠n","Tapacocha","Ticapampa"],"Santa":["Chimbote","Coishco","Macate","Moro","Nepe√±a","Nuevo Chimbote","Samanco","Santa","C√°ceres del Per√∫"],"Sihuas":["Sihuas","Acobamba","Alfonso Ugarte","Cashapampa","Chingalpo","Huayllabamba","Quiches","Ragash","San Juan","Sicsibamba"],"Yungay":["Yungay","Cascapara","Mancos","Matacoto","Quillo","Ranrahirca","Shupluy","Yanama"]}},
  "APUR√çMAC": {"provincias":["Abancay","Andahuaylas","Antabamba","Aymaraes","Chincheros","Cotabambas","Grau"],"distritos":{"Abancay":["Abancay","Chacoche","Circa","Curahuasi","Huanipaca","Lambrama","Pichirhua","San Pedro de Cachora","Tamburco"],"Andahuaylas":["Andahuaylas","Andarapa","Chiara","Huancarama","Huancaray","Huayana","Kaquiabamba","Kishuara","Pacobamba","Pacucha","Pampachiri","Pomacocha","San Antonio de Cachi","San Jer√≥nimo","San Miguel de Chaccrampa","Santa Mar√≠a de Chicmo","Talavera","Tumay Huaraca","Turpo","Kaquiabamba"],"Antabamba":["Antabamba","El Oro","Huaquirca","Juan Espinoza Medrano","Oropesa","Pachaconas","Sabaino"],"Aymaraes":["Chalhuanca","Capaya","Caraybamba","Chapimarca","Colcabamba","Cotaruse","Huayllo","Justo Apu Sahuaraura","Laco","Lucre","Pocohuanca","San Juan de Chac√±a","Sa√±ayca","Soraya","Tapairihua","Tintay","Toraya","Yanaca"],"Chincheros":["Chincheros","Anco-Huallo","Cocharcas","Huaccana","Ocobamba","Ongoy","Uranmarca","Ranracancha"],"Cotabambas":["Tambobamba","Cotabambas","Coyllurqui","Haquira","Mara","Challhuahuacho"],"Grau":["Chuquibambilla","Curpahuasi","Gamarra","Huayllati","Mamara","Micaela Bastidas","Pataypampa","Progreso","San Antonio","Santa Rosa","Turpay","Vilcabamba","Virundo","Curasco"]}},
  "AREQUIPA": {"provincias":["Arequipa","Caman√°","Caravel√≠","Castilla","Caylloma","Condesuyos","Islay","La Uni√≥n"],"distritos":{"Arequipa":["Arequipa","Alto Selva Alegre","Cayma","Cerro Colorado","Characato","Chiguata","Jacobo Hunter","La Joya","Mariano Melgar","Miraflores","Mollebaya","Paucarpata","Pocsi","Polobaya","Queque√±a","Saband√≠a","Sachaca","San Juan de Siguas","San Juan de Tarucani","Santa Isabel de Siguas","Santa Rita de Siguas","Socabaya","Tiabaya","Uchumayo","Vitor","Yanahuara","Yarabamba","Yura"],"Caman√°":["Caman√°","Jos√© Mar√≠a Quimper","Mariano Nicol√°s Valc√°rcel","Mariscal C√°ceres","Nicol√°s de Pi√©rola","Oco√±a","Quilca","Samuel Pastor"],"Caravel√≠":["Caravel√≠","Acar√≠","Atico","Atiquipa","Bella Uni√≥n","Cahuacho","Chala","Chaparra","Huanuhuanu","Jaqui","Lomas","Quicacha","Yauca"],"Castilla":["Aplao","Andagua","Ayo","Chachas","Chilcaymarca","Choco","Huancarqui","Machaguay","Orcopampa","Pampacolca","Tip√°n","U√±√≥n","Uraca","Viraco"],"Caylloma":["Chivay","Achoma","Cabanaconde","Callalli","Caylloma","Coporaque","Huambo","Huanca","Ichupampa","Lari","Lluta","Maca","Madrigal","San Antonio de Chuca","Sibayo","Tapay","Tisco","Tuti","Yanque","Majes"],"Condesuyos":["Chuquibamba","Andaray","Cayarani","Chichas","Iray","R√≠o Grande","Salamanca","Yanaquihua"],"Islay":["Mollendo","Cocachacra","Dean Valdivia","Islay","Mej√≠a","Punta de Bomb√≥n"],"La Uni√≥n":["Cotahuasi","Alca","Charcana","Huaynacotas","Pampamarca","Puyca","Quechualla","Sayla","Taur√≠a","Tomepampa","Toro"]}},
  "AYACUCHO": {"provincias":["Huamanga","Cangallo","Huanca Sancos","Huanta","La Mar","Lucanas","Parinacochas","P√°ucar del Sara Sara","Sucre","V√≠ctor Fajardo","Vilcashuam√°n"],"distritos":{"Huamanga":["Ayacucho","Acocro","Acos Vinchos","Carmen Alto","Chiara","Ocros","Pacaycasa","Quinua","San Jos√© de Ticllas","San Juan Bautista","Santiago de Pischa","Socos","Tambillo","Vinchos","Jes√∫s Nazareno","Andr√©s Avelino C√°ceres Dorregaray"],"Cangallo":["Cangallo","Chuschi","Los Morochucos","Mar√≠a Parado de Bellido","Paras","Totos"],"Huanca Sancos":["Sancos","Carapo","Sacsamarca","Santiago de Lucanamarca"],"Huanta":["Huanta","Ayahuanco","Huamanguilla","Igua√≠n","Luricocha","Santillana","Sivia","Llochegua"],"La Mar":["San Miguel","Anco","Ayna","Chilcas","Chungui","Luis Carranza","Santa Rosa","Tambo","Samugari"],"Lucanas":["Puquio","Aucara","Cabana","Carmen Salcedo","Chavi√±a","Chipao","Huac-Huas","Laramate","Leoncio Prado","Llauta","Lucanas","Oca√±a","Otoca","Saisa","San Crist√≥bal","San Juan","San Pedro","San Pedro de Palco","Sancos","Santa Ana de Huaycahuacho","Santa Luc√≠a","Sapallanga","Sirca","Todos Santos","Vilcanchos"],"Parinacochas":["Coracora","Chumpi","Coronel Casta√±eda","Pacapausa","Pullo","Puyusca","San Francisco de Ravacayco","Upahuacho"],"P√°ucar del Sara Sara":["Pausa","Colta","Corculla","Lampa","Marcabamba","Oyolo","Pararca","San Javier de Alpabamba","San Jos√© de Ushua","Sara Sara"],"Sucre":["Querobamba","Bel√©n","Chalcos","Chilcayoc","Huaca√±a","Morcolla","Paico","San Pedro de Larcay","San Salvador de Quije","Santiago de Paucaray","Soras"],"V√≠ctor Fajardo":["Huancapi","Alcamenca","Apongo","Asquipata","Canaria","Cayara","Colca","Huamanquiquia","Huancaraylla","Hualla","Sarhua","Vilcanchos"],"Vilcashuam√°n":["Vilcashuam√°n","Accomarca","Carhuanca","Concepci√≥n","Huambalpa","Independencia","Saurama","Vischongo"]}},
  "CAJAMARCA": {"provincias":["Cajamarca","Cajabamba","Celend√≠n","Chota","Contumaz√°","Cutervo","Hualgayoc","Ja√©n","San Ignacio","San Marcos","San Miguel","San Pablo","Santa Cruz"],"distritos":{"Cajamarca":["Cajamarca","Asunci√≥n","Chetilla","Cospan","Enca√±ada","Jes√∫s","Llacanora","Los Ba√±os del Inca","Magdalena","Matara","Namora","San Juan"],"Cajabamba":["Cajabamba","Cachachi","Condebamba","Sitacocha"],"Celend√≠n":["Celend√≠n","Chumuch","Cortegana","Huasmin","Jorge Ch√°vez","Jos√© G√°lvez","Miguel Iglesias","Oxamarca","Sorochuco","Sucre","Utco","La Libertad de Pall√°n"],"Chota":["Chota","Angu√≠a","Chadin","Chiguirip","Chimban","Choropampa","Cochabamba","Conch√°n","Huambos","Lajas","Llama","Miracosta","Paccha","Pion","Querocoto","San Juan de Licupis","Tacabamba","Tocmoche","Chalamarca"],"Contumaz√°":["Contumaz√°","Chilete","Cupisnique","Guzmango","San Benito","San Buenaventura","Tantarica","Yon√°n"],"Cutervo":["Cutervo","Callayuc","Choros","Cujillo","La Ramada","Pimpingos","Querocoto","San Andr√©s de Cutervo","San Juan de Cutervo","San Luis de Lucma","Santa Cruz","Santo Domingo de la Capilla","Santo Tom√°s","Socota","Toribio Casanova"],"Hualgayoc":["Bambamarca","Chugur","Hualgayoc"],"Ja√©n":["Ja√©n","Bellavista","Chontali","Colasay","Huabal","Las Pirias","Pomahuaca","Pucar√°","Sallique","San Felipe","San Jos√© del Alto","Santa Rosa"],"San Ignacio":["San Ignacio","Chirinos","Huarango","La Coipa","Namballe","San Jos√© de Lourdes"],"San Marcos":["Pedro G√°lvez","Chancay","Eduardo Villanueva","Gregorio Pita","Ichoc√°n","Jos√© Manuel Quiroz","Jos√© Santiago Fonseca","Llapa","Nueva Arica","San Jer√≥nimo","Tiburcio Castro"],"San Miguel":["San Miguel","Bol√≠var","Calquis","Catilluc","El Prado","La Florida","Llapa","Nanchoc","Niepos","San Gregorio","San Silvestre de Cochan","Tongod","Uni√≥n Agua Blanca"],"San Pablo":["San Pablo","San Bernardino","San Luis","Tumbad√©n"],"Santa Cruz":["Santa Cruz","Andabamba","Catache","Chancayba√±os","La Esperanza","Ninabamba","Pulan","Saucepampa","Sexi","Uticyacu","Yauyucan"]}},
  "CALLAO": {"provincias":["Callao"],"distritos":{"Callao":["Callao","Bellavista","Carmen de la Legua Reynoso","La Perla","La Punta","Ventanilla"]}},
  "CUSCO": {"provincias":["Cusco","Acomayo","Anta","Calca","Canas","Canchis","Chumbivilcas","Espinar","La Convenci√≥n","Paruro","Paucartambo","Quispicanchi","Urubamba"],"distritos":{"Cusco":["Cusco","Ccorca","Poroy","San Jer√≥nimo","San Sebasti√°n","Santiago","Saylla","Wanchaq"],"Acomayo":["Acomayo","Acopia","Acos","Mosoc Llacta","Pomacanchi","Rondocan","Sangarar√°"],"Anta":["Anta","Ancahuasi","Cachimayo","Chinchaypujio","Huarocondo","Limatambo","Mollepata","Pucyura","Zurite"],"Calca":["Calca","Coya","Lamay","Lares","Pisac","San Salvador","Taray","Yanatile"],"Canas":["Yanaoca","Checca","Kunturkanki","Langui","Layo","Pampamarca","Quehue","T√∫pac Amaru"],"Canchis":["Sicuani","Checacupe","Combapata","Marangani","Pitumarca","San Pablo","San Pedro","Tinta"],"Chumbivilcas":["Santo Tom√°s","Capacmarca","Chamaca","Colquemarca","Livitaca","Llusco","Qui√±ota","Velille"],"Espinar":["Espinar","Condoroma","Coporaque","Ocoruro","Pallpata","Pichigua","Suykutambo","Alto Pichigua"],"La Convenci√≥n":["Santa Ana","Echarate","Huayopata","Maranura","Ocobamba","Quellouno","Kimbiri","Santa Teresa","Vilcabamba","Pichari","Inkawasi","Vilcabamba"],"Paruro":["Paruro","Accha","Ccapi","Colcha","Huanoquite","Omacha","Paccaritambo","Pillpinto","Yaurisque"],"Paucartambo":["Paucartambo","Caicay","Challabamba","Colquepata","Huancarani","Kos√±ipata"],"Quispicanchi":["Urcos","Andahuaylillas","Camanti","Ccarhuayo","Ccatca","Cusipata","Huaro","Lucre","Marcapata","Ocongate","Oropesa","Quiquijana"],"Urubamba":["Urubamba","Chinchero","Huayllabamba","Machupicchu","Maras","Ollantaytambo","Yucay"]}},
  "HUANCAVELICA": {"provincias":["Huancavelica","Acobamba","Angaraes","Castrovirreyna","Churcampa","Huaytar√°","Tayacaja"],"distritos":{"Huancavelica":["Huancavelica","Acobambilla","Acoria","Conayca","Cuenca","Huachocolpa","Huando","Huayllahuara","Izcuchaca","Laria","Manta","Mariscal C√°ceres","Moya","Nuevo Occoro","Palca","Pilchaca","Vilca","Yauli","Ascensi√≥n"],"Acobamba":["Acobamba","Andabamba","Anta","Caja","Marcas","Paucar√°","Pomacocha","Rosario"],"Angaraes":["Lircay","Anchonga","Callanmarca","Ccochaccasa","Chincho","Congalla","Huanca-Huanca","Huandoval","Julcan","San Antonio de Antaparco","Santo Tom√°s de Pata","Secclla"],"Castrovirreyna":["Castrovirreyna","Arma","Aurahua","Capillas","Chupamarca","Cocas","Huachos","Huaman","Huancaya","Huayllay Grande","Julcamarca","Santa Ana","Tantara","Tauripampa","San Juan","Ascensi√≥n"],"Churcampa":["Churcampa","Anco","Chinchihuasi","El Carmen","La Merced","Locroja","Paucarbamba","San Miguel de Mayocc","San Pedro de Coris","Pachamarca","Cosme"],"Huaytar√°":["Huaytar√°","Ayavi","C√≥rdova","Huayacundo Arma","Laramarca","Ocoyo","Pilpichaca","Querco","Quito-Arma","San Antonio de Cachi","San Francisco de Sangayaico","San Isidro","Santiago de Chocorvos","Santiago de Quirahuara","Santo Domingo de Capillas","Tambo"],"Tayacaja":["Pampas","Acostambo","Acraquia","Ahuaycha","Colcabamba","Daniel Hern√°ndez","Huachocolpa","Huaribamba","√ëahuimpuquio","Pazos","Quishuar","Salcabamba","Salcahuasi","San Marcos de Rocchac","Surcubamba","Tintay Puncu","Aclic","Julcan"]}},
  "HU√ÅNUCO": {"provincias":["Hu√°nuco","Ambo","Dos de Mayo","Huacaybamba","Huamal√≠es","Leoncio Prado","Mara√±√≥n","Pachitea","Puerto Inca","Lauricocha","Yarowilca"],"distritos":{"Hu√°nuco":["Hu√°nuco","Amarilis","Chinchao","Churubamba","Margos","Quisqui","San Francisco de Cayr√°n","San Pedro de Chaul√°n","Santa Mar√≠a del Valle","Yarumayu","Pillco Marca"],"Ambo":["Ambo","Cayna","Colpas","Conchamarca","Huacar","San Francisco","San Rafael","Tomay Kichwa"],"Dos de Mayo":["La Uni√≥n","Chuquis","Mar√≠as","Pachas","Quivilla","Rip√°n","Shunqui","Sillapata","Yanas"],"Huacaybamba":["Huacaybamba","Canchabamba","Cochabamba","Pinra"],"Huamal√≠es":["Llata","Arancay","Chav√≠n de Pariarca","Churubamba","Jacas Grande","Jircan","Miraflores","Monz√≥n","Punchao","Pu√±os","Singa","Tantamayo"],"Leoncio Prado":["Rupa-Rupa","Daniel Alcides Carri√≥n","Hermilio Valdiz√°n","Jos√© Crespo y Castillo","Luyando","Mariano D√°maso Beraun","Pucayacu","Castillo Grande","Shunqui"],"Mara√±√≥n":["Huacrachuco","Chol√≥n","San Buenaventura"],"Pachitea":["Panao","Chaglla","Molino","Umari"],"Puerto Inca":["Puerto Inca","Codo del Pozuzo","Honoria","Tournavista","Yuyapichis"],"Lauricocha":["Jes√∫s","Ba√±os","Jivia","Queropalca","Rondos","San Francisco de As√≠s","San Miguel de Cauri"],"Yarowilca":["Chavinillo","Cahuac","Chacabamba","Aparicio Pomares","Jacas Chico","Obas","Pampamarca","Choras"]}},
  "ICA": {"provincias":["Ica","Chincha","Nazca","Palpa","Pisco"],"distritos":{"Ica":["Ica","La Tingui√±a","Los Aquijes","Ocucaje","Pachac√∫tec","Parcona","Pueblo Nuevo","Salas","San Jos√© de Los Molinos","San Juan Bautista","Santiago","Subtanjalla","Tate","Yauca del Rosario"],"Chincha":["Chincha Alta","Alto Lar√°n","Chav√≠n","Chincha Baja","El Carmen","Grocio Prado","Pueblo Nuevo","San Juan de Yanac","San Pedro de Huacarpana","Sunampe","Tambo de Mora"],"Nazca":["Nasca","Changuillo","El Ingenio","Marcona","Vista Alegre"],"Palpa":["Palpa","Llipata","R√≠o Grande","Santa Cruz","Tibillo"],"Pisco":["Pisco","Huancano","Humay","Independencia","Paracas","San Andr√©s","San Clemente","T√∫pac Amaru Inca"]}},
  "JUN√çN": {"provincias":["Huancayo","Concepci√≥n","Chanchamayo","Jauja","Jun√≠n","Satipo","Tarma","Yauli","Chupaca"],"distritos":{"Huancayo":["Huancayo","Carhuacallanga","Chacapampa","Chicche","Chilca","Chongos Alto","Chupuro","Colca","Cullhuas","El Tambo","Huacrapuquio","Hualhuas","Huanc√°n","Huasicancha","Huayucachi","Ingenio","Pariahuanca","Pilcomayo","Pucar√°","Quichuay","Quilcas","San Agust√≠n","San Jer√≥nimo de Tun√°n","San Pedro de Sa√±o","Sa√±o","Sapallanga","Sicaya","Santo Domingo de Acobamba","Viques"],"Concepci√≥n":["Concepci√≥n","Aco","Andamarca","Chambara","Cochas","Comas","Heroinas Toledo","Manzanares","Mariscal Castilla","Matahuasi","Mito","Nueve de Julio","Orcotuna","San Jos√© de Quero","Santa Rosa de Ocopa"],"Chanchamayo":["Chanchamayo","Peren√©","Pichanaqui","San Luis de Shuaro","San Ram√≥n","Vitoc"],"Jauja":["Jauja","Acolla","Apata","Ataura","Canchayllo","Curicaca","El Mantaro","Huamal√≠","Huaripampa","Huertas","Janjaillo","Julc√°n","Leonor Ord√≥√±ez","Llocllapampa","Marco","Masma","Masma Chicche","Molinopampa","Monobamba","Muqui","Muquiyauyo","Paca","Paccha","Panc√°n","Parco","Pomacancha","Ricr√°n","San Lorenzo","San Pedro de Chunan","Sausa","Sincos","Tunan","Yauli","Yauyos"],"Jun√≠n":["Jun√≠n","Carhuamayo","Ondores","Ulcumayo"],"Satipo":["Satipo","Coviriali","Llaylla","Mazamari","Pampa Hermosa","Pangoa","R√≠o Negro","R√≠o Tambo"],"Tarma":["Tarma","Acobamba","Huaricolca","Huasahuasi","La Uni√≥n","Palca","Palcamayo","San Pedro de Cajas","Tapo"],"Yauli":["La Oroya","Chacapalpa","Huay-Huay","Marcapomacocha","Morococha","Paccha","Santa B√°rbara de Carhuacay√°n","Santa Rosa de Sacco","Suitucancha","Yauli"],"Chupaca":["Chupaca","Ahuac","Chongos Bajo","Hu√°chac","Huamancaca Chico","San Juan de Iscos","San Juan de Jarpa","Tres de Diciembre","Yanacancha"]}},
  "LA LIBERTAD": {"provincias":["Trujillo","Ascope","Bol√≠var","Chep√©n","Julc√°n","Otuzco","Pacasmayo","Pataz","S√°nchez Carri√≥n","Santiago de Chuco","Gran Chim√∫","Vir√∫"],"distritos":{"Trujillo":["Trujillo","El Porvenir","Florencia de Mora","Huanchaco","La Esperanza","Laredo","Moche","Poroto","Salaverry","Simbal","V√≠ctor Larco Herrera"],"Ascope":["Ascope","Chicama","Chocope","Magdalena de Cao","Paij√°n","R√°zuri","Santiago de Cao","Casa Grande"],"Bol√≠var":["Bol√≠var","Bambamarca","Huancabamba","La Esperanza","Uchumarca","Ucuncha"],"Chep√©n":["Chep√©n","Pacanga","Pueblo Nuevo"],"Julc√°n":["Julc√°n","Calamarca","Carabamba","Huaso"],"Otuzco":["Otuzco","Agallpampa","Charat","Huaranchal","La Cuesta","Mache","Paranday","Salpo","Sinsicap","Usquil"],"Pacasmayo":["San Pedro de Lloc","Guadalupe","Jequetepeque","Pacasmayo","San Jos√©"],"Pataz":["Tayabamba","Buldibuyo","Chillia","Huancaspata","Huaylillas","Huayo","Ong√≥n","Parcoy","Pataz","P√≠as","Santiago de Challas","Taurija","Urpay"],"S√°nchez Carri√≥n":["Huamachuco","Chugay","Cochorco","Curgos","Huamachuco","Marcabal","Sanagor√°n","Sar√≠n","Sartimbamba"],"Santiago de Chuco":["Santiago de Chuco","Angasmarca","Cachicad√°n","Mollebamba","Quiruvilca","Santa Cruz de Chuca","Sitabamba","Usquil"],"Gran Chim√∫":["Cascas","Lucma","Marmot","Sayapullo"],"Vir√∫":["Vir√∫","Chao","Guadalupito"]}},
  "LAMBAYEQUE": {"provincias":["Chiclayo","Ferre√±afe","Lambayeque"],"distritos":{"Chiclayo":["Chiclayo","Chongoyape","Eten","Eten Puerto","Jos√© Leonardo Ortiz","La Victoria","Lagunas","Monsef√∫","Nueva Arica","Oyot√∫n","Picsi","Pimentel","Reque","Santa Rosa","Sa√±a","Cayalt√≠","Patapo","Pomalca","Pucal√°","Tum√°n"],"Ferre√±afe":["Ferre√±afe","Ca√±aris","Incahuasi","Manuel Antonio Mesones Muro","Pitipo","Pueblo Nuevo"],"Lambayeque":["Lambayeque","Chochope","Illimo","Jayanca","Mochum√≠","Morrop√≥n","Motupe","Olmos","Pacora","Salas","San Jos√©","T√∫cume"]}},
  "LIMA": {"provincias":["Lima","Barranca","Cajatambo","Canta","Ca√±ete","Huaral","Huarochir√≠","Huaura","Oy√≥n","Yauyos"],"distritos":{"Lima":["Lima","Ancon","Ate","Barranco","Bre√±a","Carabayllo","Chaclacayo","Chorrillos","Cieneguilla","Comas","El Agustino","Independencia","Jes√∫s Mar√≠a","La Molina","La Victoria","Lince","Los Olivos","Lurigancho","Lur√≠n","Magdalena del Mar","Miraflores","Pachac√°mac","Pucusana","Puente Piedra","Punta Hermosa","Punta Negra","R√≠mac","San Bartolo","San Borja","San Isidro","San Juan de Lurigancho","San Juan de Miraflores","San Luis","San Mart√≠n de Porres","San Miguel","Santa Anita","Santa Mar√≠a del Mar","Santa Rosa","Santiago de Surco","Surquillo","Villa El Salvador","Villa Mar√≠a del Triunfo"],"Barranca":["Barranca","Paramonga","Pativilca","Supe","Supe Puerto"],"Cajatambo":["Cajatambo","Copa","Gorgor","Huancap√≥n","Manas"],"Canta":["Canta","Arahuay","Huamantanga","Huaros","Lachaqui","San Buenaventura","Santa Rosa de Quives"],"Ca√±ete":["San Vicente de Ca√±ete","Asia","Calango","Cerro Azul","Chilca","Coayllo","Imperial","Lunahuan√°","Mala","Nuevo Imperial","Pacar√°n","Quilman√°","San Antonio","San Luis","Santa Cruz de Flores","Z√∫√±iga"],"Huaral":["Huaral","Atavillos Alto","Atavillos Bajo","Aucallama","Chancay","Ihuar√≠","Lampi√°n","Pacaraos","San Miguel de Acos","Santa Cruz de Andamarca","Sumbilca","Veintisiete de Noviembre"],"Huarochir√≠":["Matucana","Antioqu√≠a","Callahuanca","Carampoma","Chicla","Cuenca","Huachupampa","Huanza","Huarochir√≠","Lahuaytambo","Langa","Laraos","Mariatana","Ricardo Palma","San Andr√©s de Tupicocha","San Antonio","San Bartolom√©","San Damian","San Juan de Iris","San Juan de Tantaranche","San Lorenzo de Quinti","San Mateo","San Mateo de Otao","San Pedro de Casta","San Pedro de Huancayre","Sangallaya","Santa Cruz de Cocachacra","Santa Eulalia","Santiago de Anchucaya","Santiago de Tuna","Santo Domingo de los Olleros","Surco","Tomas","Chepel√≠n"],"Huaura":["Huacho","√Åmbar","Caleta de Carqu√≠n","Checras","Hualmay","Huaura","Leoncio Prado","Paccho","Santa Leonor","Santa Mar√≠a","Sayan","V√©gueta"],"Oy√≥n":["Oy√≥n","Andajes","Caujul","Cochamarca","Nav√°n","Pachangara"],"Yauyos":["Yauyos","Alis","Ayaviri","Az√°ngaro","Cacra","Carania","Catahuasi","Chocos","Cochas","Colonia","Hongos","Huampara","Huancaya","Huang√°scar","Huant√°n","Hua√±ec","Laraos","Lincha","Made√°n","Miraflores","Omas","Putinza","Quinches","Quinocay","San Joaqu√≠n","San Pedro de Pilas","Tanta","Tauripampa","Tomas","Tupe","Vi√±ac","Vitis"]}},
  "LORETO": {"provincias":["Maynas","Alto Amazonas","Loreto","Mariscal Ram√≥n Castilla","Requena","Ucayali","Datem del Mara√±√≥n","Putumayo"],"distritos":{"Maynas":["Iquitos","Alto Nanay","Fernando Lores","Indiana","Las Amazonas","Maz√°n","Napo","Punchana","Putumayo","Torres Causana","Bel√©n","San Juan Bautista"],"Alto Amazonas":["Yurimaguas","Balsapuerto","Jeberos","Lagunas","Santa Cruz","Teniente C√©sar L√≥pez Rojas"],"Loreto":["Nauta","Parinari","Tigre","Trompeteros","Urarinas"],"Mariscal Ram√≥n Castilla":["Caballococha","Maz√°n","Pebas","Yavari","Ram√≥n Castilla"],"Requena":["Requena","Alto Tapiche","Capelo","Emilio San Mart√≠n","Maqu√≠a","Puinahua","Saquena","Soplin","Tapiche","Yaquerana","Jenaro Herrera"],"Ucayali":["Contamana","Inahuaya","Padre M√°rquez","Pampa Hermosa","Sarayacu","Vargas Guerra"],"Datem del Mara√±√≥n":["Barranca","Cahuapanas","Manseriche","Morona","Pastaza","Andoas"],"Putumayo":["Putumayo","Rosa Panduro","Teniente Manuel Clavero","Yaguas"]}},
  "MADRE DE DIOS": {"provincias":["Tambopata","Manu","Tahuamanu"],"distritos":{"Tambopata":["Tambopata","Inambari","Las Piedras","Laberinto"],"Manu":["Manu","Fitzcarrald","Madre de Dios","Huepetuhe"],"Tahuamanu":["I√±apari","Iberia","Tahuamanu"]}},
  "MOQUEGUA": {"provincias":["Mariscal Nieto","General S√°nchez Cerro","Ilo"],"distritos":{"Mariscal Nieto":["Moquegua","Carumas","Cuchumbaya","Samegua","San Crist√≥bal","Torata"],"General S√°nchez Cerro":["Omate","Chojata","Coalaque","Ichu√±a","La Capilla","Lloque","Matalaque","Puquina","Quinistaquillas","Ubinas","Yunga"],"Ilo":["Ilo","El Algarrobal","Pacocha"]}},
  "PASCO": {"provincias":["Pasco","Daniel Alcides Carri√≥n","Oxapampa"],"distritos":{"Pasco":["Chaupimarca","Huach√≥n","Huariaca","Huayllay","Ninacaca","Pallanchacra","Paucartambo","San Francisco de As√≠s de Yarusyac√°n","Sim√≥n Bol√≠var","Ticlacay√°n","Tinyahuarco","Vicco","Yanacancha"],"Daniel Alcides Carri√≥n":["Yanahuanca","Chacay√°n","Goyllarisquizga","Paucar","San Pedro de Pillao","Santa Ana de Tusi","Tapuc","Vilcabamba"],"Oxapampa":["Oxapampa","Chontabamba","Huancabamba","Palcazu","Pozuzo","Puerto Berm√∫dez","Villa Rica"]}},
  "PIURA": {"provincias":["Piura","Ayabaca","Huancabamba","Morrop√≥n","Paita","Sullana","Talara","Sechura"],"distritos":{"Piura":["Piura","Castilla","Catacaos","Cura Mori","El Tall√°n","La Arena","La Uni√≥n","Las Lomas","Tambo Grande","Veintis√©is de Octubre"],"Ayabaca":["Ayabaca","Frias","Jilil√≠","Lagunas","Montero","Pacaipampa","Paimas","Sapillica","Sicchez","Suyo"],"Huancabamba":["Huancabamba","Canchaque","El Carmen de la Frontera","Huarmaca","Lalaquiz","San Miguel de El Faique","S√≥ndor","Sondorillo"],"Morrop√≥n":["Chulucanas","Buenos Aires","Chalaco","La Matanza","Morrop√≥n","Salitral","San Juan de Bigote","Santa Catalina de Mossa","Santo Domingo","Yamango"],"Paita":["Paita","Amotape","Arenal","Col√°n","La Huaca","Tamarindo","Vichayal"],"Sullana":["Sullana","Bellavista","Ignacio Escudero","Lancones","Marcavelica","Miguel Checa","Querecotillo","Salitral"],"Talara":["Pari√±as","El Alto","La Brea","Lobitos","Los √ìrganos","M√°ncora"],"Sechura":["Sechura","Bellavista de la Uni√≥n","Bernal","Cristo Nos Valga","Vice","Rinconada Llicuar"]}},
  "PUNO": {"provincias":["Puno","Az√°ngaro","Carabaya","Chucuito","El Collao","Huancan√©","Lampa","Melgar","Moho","San Antonio de Putina","San Rom√°n","Sandia","Yunguyo"],"distritos":{"Puno":["Puno","Acora","Amantani","Atuncolla","Capachica","Chucuito","Coata","Huata","Ma√±azo","Paucarcolla","Pichacani","Plateria","San Antonio","Tiquillaca","Vilque"],"Az√°ngaro":["Az√°ngaro","Achaya","Arapa","Asillo","Caminaca","Chupa","Jos√© Domingo Choquehuanca","Mu√±ani","Potoni","Saman","San Ant√≥n","San Jos√©","San Juan de Salinas","Santiago de Pupuja","Tirapata"],"Carabaya":["Macusani","Ajoyani","Ayapata","Coasa","Corani","Crucero","Ituata","Ollachea","San Gaban","Usicayos"],"Chucuito":["Juli","Desaguadero","Huacullani","Kelluyo","Pisacoma","Pomata","Zepita"],"El Collao":["Ilave","Capazo","Pilcuyo","Santa Rosa","Conduriri"],"Huancan√©":["Huancan√©","Cojata","Huatasani","Inchupalla","Pusi","Rosaspata","Taraco","Vilque Chico"],"Lampa":["Lampa","Cabanilla","Calapuja","Nicasio","Ocuviri","Palca","Parat√≠a","Pucar√°","Santa Luc√≠a","Vilavila"],"Melgar":["Ayaviri","Antauta","Cupi","Llalli","Macari","Nu√±oa","Orurillo","Santa Rosa","Umachiri"],"Moho":["Moho","Conima","Huayrapata","Tilali"],"San Antonio de Putina":["Putina","Ananea","Pedro Vilca Apaza","Quilcapuncu","Sina"],"San Rom√°n":["Juliaca","Cabanillas","Caracoto","San Miguel"],"Sandia":["Sandia","Cuyocuyo","Limbani","Patambuco","Phara","Quiaca","San Juan del Oro","Yanahuaya","Alto Inambari"],"Yunguyo":["Yunguyo","Anapia","Copani","Cuturapi","Ollaraya","Tinicachi","Unicachi"]}},
  "SAN MART√çN": {"provincias":["Moyobamba","Bellavista","El Dorado","Huallaga","Lamas","Mariscal C√°ceres","Picota","Rioja","San Mart√≠n","Tocache"],"distritos":{"Moyobamba":["Moyobamba","Calzada","Habana","Jepelacio","Soritor","Yantalo"],"Bellavista":["Bellavista","Alto Biavo","Bajo Biavo","Huallaga","San Pablo","San Rafael"],"El Dorado":["San Jos√© de Sisa","Agua Blanca","San Mart√≠n","Santa Rosa","Shatoja"],"Huallaga":["Saposoa","Alto Saposoa","El Eslab√≥n","Piscoyacu","Sacanche","Tingo de Saposoa"],"Lamas":["Lamas","Alonso de Alvarado","Barranquita","Caynarachi","Cu√±umbuqui","Pinto Recodo","Rumisapa","San Roque de Cumbaza","Shanao","Tabalosos","Zapatero"],"Mariscal C√°ceres":["Juanju√≠","Campanilla","Huicungo","Pachiza","Pajarillo"],"Picota":["Picota","Buenos Aires","Caspisapa","Pilluana","Pucacaca","San Crist√≥bal","San Hilari√≥n","Shamboyacu","Tingo de Ponasa","Tres Unidos"],"Rioja":["Rioja","Awajun","Elias Soplin Vargas","Nueva Cajamarca","Pardo Miguel","Posic","San Fernando","Yorongos","Yuracyacu"],"San Mart√≠n":["Tarapoto","Alberto Leveau","Cacatachi","Chazuta","Chipurana","El Porvenir","Huimbayoc","Juan Guerra","La Banda de Shilcayo","Morales","Papaplaya","San Antonio","Sauce","Shapaja"],"Tocache":["Tocache","Nuevo Progreso","Polvora","Shunte","Uchiza"]}},
  "TACNA": {"provincias":["Tacna","Candarave","Jorge Basadre","Tarata"],"distritos":{"Tacna":["Tacna","Alto de la Alianza","Calana","Ciudad Nueva","Incl√°n","Pach√≠a","Palca","Pocollay","Sama","Coronel Gregorio Albarrac√≠n Lanchipa"],"Candarave":["Candarave","Cairani","Camilaca","Curibaya","Hualhuas","Quilahuani"],"Jorge Basadre":["Locumba","Ilabaya","Ite"],"Tarata":["Tarata","Chucatamani","Estique","Estique-Pampa","Sitajara","Susapaya","Tarucachi","Ticaco"]}},
  "TUMBES": {"provincias":["Tumbes","Contralmirante Villar","Zarumilla"],"distritos":{"Tumbes":["Tumbes","Corrales","La Cruz","Pampas de Hospital","San Jacinto","San Juan de la Virgen"],"Contralmirante Villar":["Zorritos","Casitas","Canoas de Punta Sal"],"Zarumilla":["Zarumilla","Aguas Verdes","Matapalo","Papayal"]}},
  "UCAYALI": {"provincias":["Coronel Portillo","Atalaya","Padre Abad","Pur√∫s"],"distritos":{"Coronel Portillo":["Calleria","Campoverde","Ipar√≠a","Masisea","Yarinacocha","Nueva Requena","Manantay"],"Atalaya":["Raymondi","Sepahua","Tahuania","Yurua"],"Padre Abad":["Padre Abad","Irazola","Curimana","Neshuya","Alexander von Humboldt"],"Pur√∫s":["Pur√∫s"]}}
};

Object.keys(ubigeos).forEach(depto => {
  const opt = document.createElement('option');
  opt.value = depto;
  opt.textContent = depto;
  el.departamento.appendChild(opt);
});

el.departamento.addEventListener('change', () => {
  el.provincia.innerHTML = '<option value="">Seleccione...</option>';
  el.distrito.innerHTML = '<option value="">Seleccione...</option>';
  const depto = ubigeos[el.departamento.value];
  if (!depto) return;
  el.provincia.innerHTML = '<option value="">Seleccione...</option>' +
    depto.provincias.map(p => `<option value="${p}">${p}</option>`).join('');
});

el.provincia.addEventListener('change', () => {
  el.distrito.innerHTML = '<option value="">Seleccione...</option>';
  const dists = ubigeos[el.departamento.value]?.distritos?.[el.provincia.value] || [];
  el.distrito.innerHTML = '<option value="">Seleccione...</option>' +
    dists.map(d => `<option value="${d}">${d}</option>`).join('');
});
</script>
</body>
</html>
